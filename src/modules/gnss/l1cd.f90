! l1cd.f90
! Mac Radigan

  module l1cd

! L1Cpi(t) = [ W_p(0..b-2;w) 0 1 1 0 1 0 0 W_p(b+6..10229;w) ]
!
!   where
!
!     p   is the order of the group ( Z10229 )
!     b   is the Insertion Index ( for sequence 0110100 )
!     w   is the Weil index ( lag )
!
! see also:  IS-GPS-800D (24 Sep 2013), page 7
!            http://www.gps.gov/technical/icwg/IS-GPS-800D.pdf

! References:
!
!   =================================================================
!   IS-GPS-800D (24 Sep 2013), pages 10-12
!   Table 3.2-2 L1C Ranging Codes Parameter Assignments (sheets 1-3)
!   =================================================================
!         L1Cp(t)                        L1Cd(t)
!   ---   ----------------------------   ----------------------------
!   PRN   Weil Indx  Initial  Final      Weil Indx  Initial  Final
!   (#)   (w)  (p)   (x0)     (xN)       (w)  (p)   (x0)     (xN)
!   ---   ---- ----  -------- --------   ---- ----- -------- --------
!   001   5111 00412 05752067 20173742   5097 00181 77001425 52231646
!   002   5109 00161 70146401 35437154   5110 00359 23342754 46703351
!   003   5108 00001 32066222 00161056   5079 00072 30523404 00145161
!   004   5106 00303 72125121 71435437   4403 01110 03777635 11261273
!   005   5103 00207 42323273 15035661   4121 01480 10505640 71364603
!   006   5101 04971 01650642 32606570   5043 05034 42134174 55012662
!   007   5100 04496 21303446 03475644   5042 04622 00471711 30373701
!   008   5098 00005 35504263 11316575   5104 00001 32237045 07706523
!   009   5095 04557 66434311 23047575   4940 04547 16004766 71741157
!   010   5094 00485 52631623 07355246   5035 00826 66234727 42347523
!   011   5093 00253 04733076 15210113   4372 06284 03755314 12746122
!   012   5091 04676 50352603 72643606   5064 04195 20604227 34634113
!   013   5090 00001 32026612 63457333   5084 00368 25477233 47555063
!   014   5081 00066 07476042 46623624   5048 00001 32025443 01221116
!   015   5080 04485 22210746 35467322   4950 04796 35503400 37125437
!   016   5069 00282 30706376 70116567   5019 00523 70504407 32203664
!   017   5068 00193 75764610 62731643   5076 00151 26163421 62162634
!   018   5054 05211 73202225 14040613   3736 00713 52176727 35012616
!   019   5044 00729 47227426 07750525   4993 09850 72557314 00437232
!   020   5027 04848 16064126 37171211   5060 05734 62043206 32130365
!   021   5026 00982 66415734 01302134   5061 00034 07151343 51515733
!   022   5014 05955 27600270 37672235   5096 06142 16027175 73662313
!   023   5004 09805 66101627 32201230   4983 00190 26267340 55416712
!   024   4980 00670 17717055 37437553   4783 00644 36272365 22550142
!   025   4915 00464 47500232 23310544   4991 00467 67707677 31506062
!   026   4909 00029 52057615 07152415   4815 05384 07760374 44603344
!   027   4893 00429 76153566 02571041   4443 00801 73633310 05252052
!   028   4885 00394 22444670 52270664   4769 00594 30401257 70603616
!   029   4832 00616 62330044 61317104   4879 04450 72606251 51643216
!   030   4824 09457 13674337 43137330   4894 09437 37370402 30417163
!   031   4591 04429 60635146 20336467   4985 04307 74255661 20074570
!   032   3706 04771 73527653 40745656   5056 05906 10171147 26204176
!   033   5092 00365 63772350 50272475   4921 00378 12242515 07105451
!   034   4986 09705 33564215 75604301   5036 09448 17426100 31062227
!   035   4965 09489 52236055 52550266   4812 09432 75647756 36516016
!   036   4920 04193 64506521 15334214   4838 05849 71265340 07641474
!   037   4917 09947 73561133 53445703   4855 05547 74355073 35065520
!   003   4858 00824 12647121 71136024   4904 09546 45253014 03155010
!   039   4847 00864 16640265 01607455   4753 09132 12452274 34041736
!   040   4790 00347 11161337 73467421   4483 00403 07011213 20162561
!   041   4770 00677 22055260 54372454   4942 03766 35143750 01603755
!   042   4318 06544 11546064 11526534   4813 00003 26442600 40541055
!   043   4126 06312 24765004 16522173   4957 00684 67214123 64750626
!   044   3961 09804 14042504 74053703   4618 09711 62274362 72550016
!   045   3790 00278 53512265 52211303   4669 00333 23371051 36130364
!   046   4911 09461 15317006 72655147   4969 06124 25121057 25236175
!   047   4881 00444 16151224 01212152   5031 10216 20362622 43732204
!   048   4827 04839 67454561 10410122   5038 04251 33050463 02316015
!   049   4795 04144 47542743 22473073   4740 09893 65334051 00212370
!   050   4789 09875 65057230 63145220   4073 09884 65523456 35163655
!   051   4725 00197 77415771 65734110   4843 04627 53741004 33771603
!   052   4675 01156 75364651 25167435   4979 04449 66360341 41161255
!   053   4539 04674 75664330 17524136   4867 09798 34421651 76257261
!   054   4535 10035 44600202 47064764   4964 00985 04530741 33512503
!   055   4458 04504 23211425 14016156   5025 04272 12621031 16237466
!   056   4197 00005 51504740 11723025   4579 00126 62330452 24120336
!   057   4096 09937 47712554 76760325   4390 10024 67510404 11103121
!   058   3484 00430 67325233 04724615   4763 00434 00726605 36467526
!   059   3481 00005 61517015 72504743   4612 01029 00200154 66444010
!   060   3393 00355 43217554 51215201   4784 00561 37533004 70455364
!   061   3175 00909 52520062 00630473   3716 00289 73771510 26726105
!   062   2360 01622 77073716 71217605   4703 00638 44071707 63663333
!   063   1852 06284 56350460 50200707   4851 04353 34665654 42142704
!   =================================================================
!
    use iso_c_binding
    implicit none
    public  :: lfsr, lfsr_init, codebook, &
               N_CODES
    private :: poly

    enum, bind(c)
      enumerator :: PRN = 0      ! #
      ! L1C Pilot
      enumerator :: L1CP__WEIL_INDEX   ! w
      enumerator :: L1CP__INSERT_INDEX ! p
      enumerator :: L1CP__REG_INITIAL  ! x0
      enumerator :: L1CP__REG_FINAL    ! xN
      ! L1C Data
      enumerator :: L1CD__WEIL_INDEX   ! w
      enumerator :: L1CD__INSERT_INDEX ! p
      enumerator :: L1CD__REG_INITIAL  ! x0
      enumerator :: L1CD__REG_FINAL    ! xN
    end enum
    
    integer :: poly = o'624145772'
    integer(c_int), parameter :: N_CODES = 210
    integer(c_int), parameter :: N_FIELDS = 9
    integer(c_int), parameter :: CODE_LENGTH = 10229

    integer(c_int), parameter :: N1 = 2
    integer(c_int), parameter :: N2 = 3
    
    integer(c_int), allocatable, dimension(:,:), save :: codebook
    
    integer(c_int), dimension(N_CODES, N_FIELDS) :: code_table
    data code_table /                                                                             &
      1,  5111,      412,  o'05752067',  o'20173742',  5097,    181,  o'77001425',  o'52231646',  &
      2,  5109,      161,  o'70146401',  o'35437154',  5110,    359,  o'23342754',  o'46703351',  &
      3,  5108,        1,  o'32066222',  o'00161056',  5079,     72,  o'30523404',  o'00145161',  &
      4,  5106,      303,  o'72125121',  o'71435437',  4403,   1110,  o'03777635',  o'11261273',  &
      5,  5103,      207,  o'42323273',  o'15035661',  4121,   1480,  o'10505640',  o'71364603',  &
      6,  5101,     4971,  o'01650642',  o'32606570',  5043,   5034,  o'42134174',  o'55012662',  &
      7,  5100,     4496,  o'21303446',  o'03475644',  5042,   4622,  o'00471711',  o'30373701',  &
      8,  5098,        5,  o'35504263',  o'11316575',  5104,      1,  o'32237045',  o'07706523',  &
      9,  5095,     4557,  o'66434311',  o'23047575',  4940,   4547,  o'16004766',  o'71741157',  &
     10,  5094,      485,  o'52631623',  o'07355246',  5035,    826,  o'66234727',  o'42347523',  &
     11,  5093,      253,  o'04733076',  o'15210113',  4372,   6284,  o'03755314',  o'12746122',  &
     12,  5091,     4676,  o'50352603',  o'72643606',  5064,   4195,  o'20604227',  o'34634113',  &
     13,  5090,        1,  o'32026612',  o'63457333',  5084,    368,  o'25477233',  o'47555063',  &
     14,  5081,       66,  o'07476042',  o'46623624',  5048,      1,  o'32025443',  o'01221116',  &
     15,  5080,     4485,  o'22210746',  o'35467322',  4950,   4796,  o'35503400',  o'37125437',  &
     16,  5069,      282,  o'30706376',  o'70116567',  5019,    523,  o'70504407',  o'32203664',  &
     17,  5068,      193,  o'75764610',  o'62731643',  5076,    151,  o'26163421',  o'62162634',  &
     18,  5054,     5211,  o'73202225',  o'14040613',  3736,    713,  o'52176727',  o'35012616',  &
     19,  5044,      729,  o'47227426',  o'07750525',  4993,   9850,  o'72557314',  o'00437232',  &
     20,  5027,     4848,  o'16064126',  o'37171211',  5060,   5734,  o'62043206',  o'32130365',  &
     21,  5026,      982,  o'66415734',  o'01302134',  5061,     34,  o'07151343',  o'51515733',  &
     22,  5014,     5955,  o'27600270',  o'37672235',  5096,   6142,  o'16027175',  o'73662313',  &
     23,  5004,     9805,  o'66101627',  o'32201230',  4983,    190,  o'26267340',  o'55416712',  &
     24,  4980,      670,  o'17717055',  o'37437553',  4783,    644,  o'36272365',  o'22550142',  &
     25,  4915,      464,  o'47500232',  o'23310544',  4991,    467,  o'67707677',  o'31506062',  &
     26,  4909,       29,  o'52057615',  o'07152415',  4815,   5384,  o'07760374',  o'44603344',  &
     27,  4893,      429,  o'76153566',  o'02571041',  4443,    801,  o'73633310',  o'05252052',  &
     28,  4885,      394,  o'22444670',  o'52270664',  4769,    594,  o'30401257',  o'70603616',  &
     29,  4832,      616,  o'62330044',  o'61317104',  4879,   4450,  o'72606251',  o'51643216',  &
     30,  4824,     9457,  o'13674337',  o'43137330',  4894,   9437,  o'37370402',  o'30417163',  &
     31,  4591,     4429,  o'60635146',  o'20336467',  4985,   4307,  o'74255661',  o'20074570',  &
     32,  3706,     4771,  o'73527653',  o'40745656',  5056,   5906,  o'10171147',  o'26204176',  &
     33,  5092,      365,  o'63772350',  o'50272475',  4921,    378,  o'12242515',  o'07105451',  &
     34,  4986,     9705,  o'33564215',  o'75604301',  5036,   9448,  o'17426100',  o'31062227',  &
     35,  4965,     9489,  o'52236055',  o'52550266',  4812,   9432,  o'75647756',  o'36516016',  &
     36,  4920,     4193,  o'64506521',  o'15334214',  4838,   5849,  o'71265340',  o'07641474',  &
     37,  4917,     9947,  o'73561133',  o'53445703',  4855,   5547,  o'74355073',  o'35065520',  &
     38,  4858,      824,  o'12647121',  o'71136024',  4904,   9546,  o'45253014',  o'03155010',  &
     39,  4847,      864,  o'16640265',  o'01607455',  4753,   9132,  o'12452274',  o'34041736',  &
     40,  4790,      347,  o'11161337',  o'73467421',  4483,    403,  o'07011213',  o'20162561',  &
     41,  4770,      677,  o'22055260',  o'54372454',  4942,   3766,  o'35143750',  o'01603755',  &
     42,  4318,     6544,  o'11546064',  o'11526534',  4813,      3,  o'26442600',  o'40541055',  &
     43,  4126,     6312,  o'24765004',  o'16522173',  4957,    684,  o'67214123',  o'64750626',  &
     44,  3961,     9804,  o'14042504',  o'74053703',  4618,   9711,  o'62274362',  o'72550016',  &
     45,  3790,      278,  o'53512265',  o'52211303',  4669,    333,  o'23371051',  o'36130364',  &
     46,  4911,     9461,  o'15317006',  o'72655147',  4969,   6124,  o'25121057',  o'25236175',  &
     47,  4881,      444,  o'16151224',  o'01212152',  5031,  10216,  o'20362622',  o'43732204',  &
     48,  4827,     4839,  o'67454561',  o'10410122',  5038,   4251,  o'33050463',  o'02316015',  &
     49,  4795,     4144,  o'47542743',  o'22473073',  4740,   9893,  o'65334051',  o'00212370',  &
     50,  4789,     9875,  o'65057230',  o'63145220',  4073,   9884,  o'65523456',  o'35163655',  &
     51,  4725,      197,  o'77415771',  o'65734110',  4843,   4627,  o'53741004',  o'33771603',  &
     52,  4675,     1156,  o'75364651',  o'25167435',  4979,   4449,  o'66360341',  o'41161255',  &
     53,  4539,     4674,  o'75664330',  o'17524136',  4867,   9798,  o'34421651',  o'76257261',  &
     54,  4535,    10035,  o'44600202',  o'47064764',  4964,    985,  o'04530741',  o'33512503',  &
     55,  4458,     4504,  o'23211425',  o'14016156',  5025,   4272,  o'12621031',  o'16237466',  &
     56,  4197,        5,  o'51504740',  o'11723025',  4579,    126,  o'62330452',  o'24120336',  &
     57,  4096,     9937,  o'47712554',  o'76760325',  4390,  10024,  o'67510404',  o'11103121',  &
     58,  3484,      430,  o'67325233',  o'04724615',  4763,    434,  o'00726605',  o'36467526',  &
     59,  3481,        5,  o'61517015',  o'72504743',  4612,   1029,  o'00200154',  o'66444010',  &
     60,  3393,      355,  o'43217554',  o'51215201',  4784,    561,  o'37533004',  o'70455364',  &
     61,  3175,      909,  o'52520062',  o'00630473',  3716,    289,  o'73771510',  o'26726105',  &
     62,  2360,     1622,  o'77073716',  o'71217605',  4703,    638,  o'44071707',  o'63663333',  &
     63,  1852,     6284,  o'56350460',  o'50200707',  4851,   4353,  o'34665654',  o'42142704',  &
     64,  5065,     9429,  o'02447300',  o'44305246',  4955,   9899,  o'64477030',  o'04573761',  &
     65,  5063,       77,  o'71725674',  o'00460475',  5018,   4629,  o'15665564',  o'03677302',  &
     66,  5055,      932,  o'25453304',  o'05674447',  4642,    669,  o'44273171',  o'47762107',  &
     67,  5012,     5973,  o'14574042',  o'36357263',  4840,   4378,  o'00245661',  o'71201242',  &
     68,  4981,      377,  o'74661664',  o'42702346',  4961,   4528,  o'05562715',  o'61227172',  &
     69,  4952,    10000,  o'23576062',  o'32521054',  4263,   9718,  o'07374424',  o'07244400',  &
     70,  4934,      951,  o'41542650',  o'42476101',  5011,   5485,  o'67651746',  o'01611101',  &
     71,  4932,     6212,  o'01104546',  o'61116204',  4922,   6222,  o'67552565',  o'23566142',  &
     72,  4786,      686,  o'33434042',  o'04262600',  4317,    672,  o'25244755',  o'52125666',  &
     73,  4762,     9352,  o'21774465',  o'01545263',  3636,   1275,  o'55656370',  o'55064114',  &
     74,  4640,     5999,  o'40262622',  o'40375205',  4884,   6083,  o'30605453',  o'33642702',  &
     75,  4601,     9912,  o'56142774',  o'40344363',  5041,   5264,  o'61613023',  o'02603370',  &
     76,  4563,     9620,  o'43202027',  o'50372155',  4912,  10167,  o'71661742',  o'50247376',  &
     77,  4388,      635,  o'04516115',  o'33621000',  4504,   1085,  o'50524332',  o'00326425',  &
     78,  3820,     4951,  o'74662364',  o'36551057',  4617,    194,  o'10511616',  o'63512437',  &
     79,  3687,     5453,  o'52076567',  o'27766445',  4633,   5012,  o'24037773',  o'10407511',  &
     80,  5052,     4658,  o'47474451',  o'52411766',  4566,   4938,  o'63337466',  o'22042777',  &
     81,  5051,     4800,  o'02211543',  o'33572343',  4702,   9356,  o'43413024',  o'27047165',  &
     82,  5047,       59,  o'23163471',  o'56266077',  4758,   5057,  o'22004634',  o'43767732',  &
     83,  5039,      318,  o'25176610',  o'31141052',  4860,    866,  o'16354567',  o'02577001',  &
     84,  5015,      571,  o'14457237',  o'42211412',  3962,      2,  o'55154652',  o'45652666',  &
     85,  5005,     565 ,  o'17254300',  o'51377401',  4882,    204,  o'77375306',  o'37351344',  &
     86,  4984,    9947 ,  o'17501057',  o'06740644',  4467,   9808,  o'62125702',  o'56325175',  &
     87,  4975,    4654 ,  o'50364001',  o'15746533',  4730,   4365,  o'60360471',  o'34116400',  &
     88,  4974,     148 ,  o'45555767',  o'10015665',  4910,    162,  o'67160364',  o'23450053',  &
     89,  4972,    3929 ,  o'00107361',  o'73402571',  4684,    367,  o'17351730',  o'27646414',  &
     90,  4962,     293 ,  o'50312164',  o'77323304',  4908,    201,  o'44400061',  o'15313636',  &
     91,  4913,     178 ,  o'20514052',  o'15263715',  4759,     18,  o'07046264',  o'32022604',  &
     92,  4907,   10142 ,  o'03627757',  o'10233327',  4880,    251,  o'26443275',  o'16273455',  &
     93,  4903,    9683 ,  o'03102361',  o'57310034',  4095,  10167,  o'42362501',  o'21406562',  &
     94,  4833,     137 ,  o'07637647',  o'77143271',  4971,     21,  o'61464206',  o'63177644',  &
     95,  4778,     565 ,  o'72757527',  o'43465043',  4873,    685,  o'00304675',  o'13677122',  &
     96,  4721,      35 ,  o'74713660',  o'00574365',  4561,     92,  o'01474411',  o'43477217',  &
     97,  4661,    5949 ,  o'47776235',  o'44401766',  4588,   1057,  o'43152275',  o'60145564',  &
     98,  4660,       2 ,  o'15011643',  o'34576343',  4773,      3,  o'66447224',  o'62047761',  &
     99,  4655,    5982 ,  o'70055175',  o'31725507',  4997,   5756,  o'32506067',  o'66757271',  &
    100,  4623,     825 ,  o'13300130',  o'67312706',  4583,     14,  o'27071504',  o'74435373',  &
    101,  4590,    9614 ,  o'51731304',  o'46621603',  4900,   9979,  o'75221557',  o'77647321',  &
    102,  4548,    9790 ,  o'17630510',  o'64345411',  4574,   9569,  o'03454571',  o'17534646',  &
    103,  4461,    5613 ,  o'63203440',  o'61602741',  4629,    515,  o'72272760',  o'07321605',  &
    104,  4442,     764 ,  o'14332223',  o'54253415',  4676,    753,  o'31706274',  o'67422013',  &
    105,  4347,     660 ,  o'76103604',  o'43302054',  4181,   1181,  o'42747572',  o'06767032',  &
    106,  4259,    4870 ,  o'37324636',  o'03453741',  5057,   9442,  o'63335441',  o'61365314',  &
    107,  4256,    4950 ,  o'26603302',  o'52233056',  4944,    669,  o'21777623',  o'41010744',  &
    108,  4166,    4881 ,  o'02757505',  o'43130175',  4401,   4834,  o'51543753',  o'53655472',  &
    109,  4155,    1151 ,  o'55462247',  o'12241054',  4586,    541,  o'21406443',  o'65430511',  &
    110,  4109,    9977 ,  o'40577461',  o'75365233',  4699,   9933,  o'61270463',  o'50672434',  &
    111,  4100,    5122 ,  o'17433077',  o'21435116',  3676,   6683,  o'07270323',  o'34014107',  &
    112,  4023,   10074 ,  o'04115442',  o'40670365',  4387,   4828,  o'23660721',  o'03066030',  &
    113,  3998,    4832 ,  o'13154727',  o'64265263',  4866,   9710,  o'77637043',  o'61651100',  &
    114,  3979,      77 ,  o'77057317',  o'30074057',  4926,  10170,  o'12433652',  o'05570472',  &
    115,  3903,    4698 ,  o'01513425',  o'75121550',  4657,   9629,  o'05304706',  o'01521516',  &
    116,  3568,    1002 ,  o'05132465',  o'54744641',  4477,    260,  o'77452705',  o'67160335',  &
    117,  5088,    5549 ,  o'50104501',  o'05312042',  4359,     86,  o'52354405',  o'03517044',  &
    118,  5050,    9606 ,  o'60523106',  o'43103551',  4673,   5544,  o'06041146',  o'34634123',  &
    119,  5020,    9228 ,  o'22246740',  o'51372531',  4258,    923,  o'76175470',  o'17153350',  &
    120,  4990,     604 ,  o'12364050',  o'42135401',  4447,    257,  o'15006176',  o'53272671',  &
    121,  4982,    4678 ,  o'32514207',  o'30171775',  4570,    507,  o'07111630',  o'37064353',  &
    122,  4966,    4854 ,  o'67423664',  o'10455535',  4486,   4572,  o'21205723',  o'20146433',  &
    123,  4949,    4122 ,  o'77266167',  o'01324227',  4362,   4491,  o'72653641',  o'14613666',  &
    124,  4947,    9471 ,  o'46461421',  o'31664661',  4481,    341,  o'10436256',  o'15435310',  &
    125,  4937,    5026 ,  o'44731317',  o'05002237',  4322,    130,  o'52721673',  o'44561325',  &
    126,  4935,     272 ,  o'40352277',  o'30601263',  4668,     79,  o'30153343',  o'41722542',  &
    127,  4906,    1027 ,  o'60334000',  o'52663163',  3967,   1142,  o'46031334',  o'33221302',  &
    128,  4901,     317 ,  o'31414460',  o'42263623',  4374,    448,  o'52705400',  o'15637431',  &
    129,  4872,     691 ,  o'21565451',  o'53041061',  4553,    875,  o'71133426',  o'57572470',  &
    130,  4865,     509 ,  o'16330346',  o'66052070',  4641,    555,  o'43512313',  o'35007473',  &
    131,  4863,    9708 ,  o'32652065',  o'04013232',  4215,   1272,  o'77673747',  o'16425373',  &
    132,  4818,    5033 ,  o'26514154',  o'67750663',  3853,   5198,  o'15633060',  o'34372463',  &
    133,  4785,    9938 ,  o'34231746',  o'54647730',  4787,   9529,  o'24027652',  o'25230460',  &
    134,  4781,    4314 ,  o'76662461',  o'15133614',  4266,   4459,  o'22453455',  o'53327223',  &
    135,  4776,   10140 ,  o'47747731',  o'01314434',  4199,  10019,  o'01620441',  o'01513007',  &
    136,  4775,    4790 ,  o'02344033',  o'56230626',  4545,   9353,  o'24652730',  o'64542663',  &
    137,  4754,    9823 ,  o'66173226',  o'45676614',  4208,   9780,  o'53141737',  o'53274351',  &
    138,  4696,    6093 ,  o'73016727',  o'47111161',  4485,    375,  o'71125036',  o'46715625',  &
    139,  4690,     469 ,  o'77312770',  o'52710401',  3714,    503,  o'07542336',  o'54164205',  &
    140,  4658,    1215 ,  o'51646142',  o'36536254',  4407,   4507,  o'16114445',  o'53416247',  &
    141,  4607,     799 ,  o'56016363',  o'02567340',  4182,    875,  o'46740433',  o'20023005',  &
    142,  4599,     756 ,  o'42604563',  o'61470650',  4203,   1246,  o'55271356',  o'44253547',  &
    143,  4596,    9994 ,  o'31351337',  o'54031347',  3788,      1,  o'32216472',  o'03043444',  &
    144,  4530,    4843 ,  o'27106364',  o'22157757',  4471,   4534,  o'23356330',  o'30510313',  &
    145,  4524,    5271 ,  o'41653674',  o'34140067',  4691,      8,  o'35551350',  o'10154063',  &
    146,  4451,    9661 ,  o'41723426',  o'13666204',  4281,   9549,  o'57761372',  o'33147336',  &
    147,  4441,    6255 ,  o'67572676',  o'30653236',  4410,   6240,  o'30253244',  o'15601652',  &
    148,  4396,    5203 ,  o'13221317',  o'26243171',  3953,     22,  o'52100453',  o'23705421',  &
    149,  4340,     203 ,  o'00546077',  o'16413664',  3465,   5652,  o'51034421',  o'41130727',  &
    150,  4335,   10070 ,  o'26001221',  o'55366035',  4801,  10069,  o'16015465',  o'71256351',  &
    151,  4296,      30 ,  o'25023624',  o'22432004',  4278,   4796,  o'50647656',  o'51262411',  &
    152,  4267,     103 ,  o'06170665',  o'13123426',  4546,   4980,  o'12572136',  o'64470526',  &
    153,  4168,    5692 ,  o'56716445',  o'52547645',  3779,     27,  o'70330016',  o'56143230',  &
    154,  4149,      32 ,  o'42176035',  o'56243100',  4115,     90,  o'15527641',  o'00472356',  &
    155,  4097,    9826 ,  o'54672466',  o'40035633',  4193,   9788,  o'11434413',  o'53374420',  &
    156,  4061,      76 ,  o'30010163',  o'23111613',  3372,    715,  o'16327052',  o'70130674',  &
    157,  3989,      59 ,  o'12460454',  o'45324016',  3786,   9720,  o'21517504',  o'71211135',  &
    158,  3966,    6831 ,  o'02433231',  o'43266171',  3491,    301,  o'22752764',  o'24514303',  &
    159,  3789,     958 ,  o'44262655',  o'33672171',  3812,   5450,  o'21041013',  o'66000624',  &
    160,  3775,    1471 ,  o'74466417',  o'45007430',  3594,   5215,  o'30150603',  o'44124121',  &
    161,  3622,   10070 ,  o'40534627',  o'47162164',  4028,     13,  o'04373224',  o'72305275',  &
    162,  3523,     553 ,  o'77507301',  o'14403627',  3652,   1147,  o'11502362',  o'34315206',  &
    163,  3515,    5487 ,  o'77047741',  o'07244501',  4224,   4855,  o'00247305',  o'65100431',  &
    164,  3492,      55 ,  o'06772006',  o'64545666',  4334,   1190,  o'72427277',  o'30205426',  &
    165,  3345,     208 ,  o'40473120',  o'12372447',  3245,   1267,  o'25646343',  o'41567071',  &
    166,  3235,     645 ,  o'34300604',  o'13076376',  3921,   1302,  o'56324170',  o'63121546',  &
    167,  3169,    5268 ,  o'65107417',  o'40367614',  3840,      1,  o'32142641',  o'65356365',  &
    168,  3157,    1873 ,  o'70400121',  o'74416333',  3514,   5007,  o'56004007',  o'55254670',  &
    169,  3082,     427 ,  o'25212235',  o'01370063',  2922,    549,  o'75210756',  o'70737175',  &
    170,  3072,     367 ,  o'74600422',  o'46656071',  4227,    368,  o'53764644',  o'70767133',  &
    171,  3032,    1404 ,  o'12032423',  o'31523361',  3376,   6300,  o'27301136',  o'74626324',  &
    172,  3030,    5652 ,  o'13632510',  o'17725050',  3560,   5658,  o'62522732',  o'50344217',  &
    173,  4582,       5 ,  o'71510055',  o'60560145',  4989,   4302,  o'64555743',  o'77720230',  &
    174,  4595,     368 ,  o'75143230',  o'70762153',  4756,    851,  o'75635153',  o'61374142',  &
    175,  4068,     451 ,  o'45520711',  o'63715635',  4624,   4353,  o'65657537',  o'63150674',  &
    176,  4871,    9595 ,  o'71255143',  o'33356000',  4446,   9618,  o'67024710',  o'73243704',  &
    177,  4514,    1030 ,  o'74432602',  o'60240565',  4174,   9652,  o'33425256',  o'62635540',  &
    178,  4439,    1324 ,  o'64502543',  o'37553063',  4551,   1232,  o'27012711',  o'62337332',  &
    179,  4122,     692 ,  o'62244257',  o'57024466',  3972,    109,  o'01142615',  o'10746114',  &
    180,  4948,    9819 ,  o'56114714',  o'56224523',  4399,  10174,  o'63104766',  o'43352532',  &
    181,  4774,    4520 ,  o'20545772',  o'71662723',  4562,   6178,  o'40126774',  o'32603456',  &
    182,  3923,    9911 ,  o'34440721',  o'52501713',  3133,   1851,  o'51100156',  o'12547126',  &
    183,  3411,     278 ,  o'27113701',  o'32506507',  4157,   1299,  o'23271257',  o'17203343',  &
    184,  4745,     642 ,  o'55315473',  o'51205405',  5053,    325,  o'54126675',  o'10756735',  &
    185,  4195,    6330 ,  o'03002035',  o'13765021',  4536,  10206,  o'52457352',  o'64624731',  &
    186,  4897,    5508 ,  o'22413634',  o'25612410',  5067,   9968,  o'57355463',  o'67422311',  &
    187,  3047,    1872 ,  o'50147661',  o'27377757',  3905,  10191,  o'43536147',  o'22501761',  &
    188,  4185,    5445 ,  o'36713526',  o'21553277',  3721,   5438,  o'77173403',  o'74416242',  &
    189,  4354,   10131 ,  o'67255070',  o'21044121',  3787,  10080,  o'00260547',  o'57357212',  &
    190,  5077,     422 ,  o'17310715',  o'71430410',  4674,    219,  o'57155443',  o'44305226',  &
    191,  4042,    4918 ,  o'20674706',  o'01406234',  3436,    758,  o'77502633',  o'30766330',  &
    192,  2111,     787 ,  o'21764400',  o'10264531',  2673,   2140,  o'25162476',  o'67406576',  &
    193,  4311,    9864 ,  o'70670250',  o'11640746',  4834,   9753,  o'54420241',  o'43473502',  &
    194,  5024,    9753 ,  o'24737373',  o'51661203',  4456,   4799,  o'75476311',  o'32402217',  &
    195,  4352,    9859 ,  o'04467202',  o'15610600',  4056,  10126,  o'50612163',  o'43454074',  &
    196,  4678,     328 ,  o'02551300',  o'70117174',  3804,    241,  o'77772455',  o'06321507',  &
    197,  5034,       1 ,  o'32252546',  o'77615261',  3672,   1245,  o'03320402',  o'22101365',  &
    198,  5085,    4733 ,  o'10121331',  o'22447126',  4205,   1274,  o'20225612',  o'67251717',  &
    199,  3646,     164 ,  o'10537634',  o'65022442',  3348,   1456,  o'55426411',  o'02047657',  &
    200,  4868,     135 ,  o'32014275',  o'41243522',  4152,   9967,  o'70477545',  o'43352227',  &
    201,  3668,     174 ,  o'13126037',  o'56605536',  3883,    235,  o'71116442',  o'04471535',  &
    202,  4211,     132 ,  o'60700561',  o'13020736',  3473,    512,  o'42077151',  o'62510717',  &
    203,  2883,     538 ,  o'75356470',  o'15605531',  3669,   1078,  o'65203721',  o'00366214',  &
    204,  2850,     176 ,  o'20543613',  o'02371410',  3455,   1078,  o'42436531',  o'32276151',  &
    205,  2815,     198 ,  o'33767061',  o'10107642',  2318,    953,  o'21017627',  o'77470652',  &
    206,  2542,     595 ,  o'05734074',  o'10115665',  2945,   5647,  o'62667326',  o'72435665',  &
    207,  2492,     574 ,  o'36277063',  o'72611614',  2947,    669,  o'56255552',  o'14160206',  &
    208,  2376,     321 ,  o'04163243',  o'56150655',  3220,   1311,  o'13413261',  o'64235022',  &
    209,  2036,     596 ,  o'71443237',  o'54060273',  4052,   5827,  o'55443510',  o'21663362',  &
    210,  1920,     491 ,  o'26113110',  o'12644254',  2953,     15,  o'67734642',  o'20171640'   &
    /
    
  contains

    recursive function lfsr(reg, k) result(new_reg) bind(c, name="l1cd_lfsr") 
      
      integer(c_int), intent(in) :: reg
      integer(c_int), intent(in) :: k
      integer(c_int)             :: new_reg ! result
      integer                    :: it
      new_reg = reg
      do it = 1, k, 1
        new_reg = ieor(new_reg, poly)
        new_reg = ishft(new_reg, 1)
      end do
      
    end function lfsr

    subroutine lfsr_init() bind(c, name="l1cd_init")
      allocate(codebook(N_CODES,CODE_LENGTH))
      return
    end subroutine lfsr_init

  end module l1cd

! *EOF*
