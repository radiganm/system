! l2c.f90
! Mac Radigan

  module l2c

! see also:  IS-GPS-200H (24 Sep 2013), page 8
!            http://www.gps.gov/technical/icwg/IS-GPS-200H.pdf
!
! References:
!
!  IS-GPS-200H (24 Sep 2013), page 8
!  Table 3-IIa. Code Phase Assignments (IIR-M, IIF, and subsequent blocks only) (sheet 1 of 2)
!  SV ID No.  GPS PRN Signal No.  Initial Shift Register State (Octal) End Shift Register State (Octal)
!  --------------------------------------------------------------------------------------------
!  1          1                   742417664   624145772                552566002    26772423620
!  2          2                   756014035   506610362                034445034    16751606620
!  3          3                   002747144   220360016                723443711    77175640520
!  4          4                   066265724   710406104                511222013    04720262420
!  5          5                   601403471   001143345                463055213    05277043320
!  6          6                   703232733   053023326                667044524    76174366520
!  7          7                   124510070   652521276                652322653    13301572620
!  8          8                   617316361   206124777                505703344    61061151120
!  9          9                   047541621   015563374                520302775    35215032320
!  10         10                  733031046   561522076                244205506    05126604620
!  11         11                  713512145   023163525                236174002    30561137320
!  12         12                  024437606   117776450                654305531    50467677320
!  13         13                  021264003   606516355                435070571    27257263420
!  14         14                  230655351   003037343                630431251    73132077120
!  15         15                  001314400   046515565                234043417    63132656320
!  16         16                  222021506   671511621                535540745    23151636020
!  17         17                  540264026   605402220                043056734    03036736620
!  18         18                  205521705   002576207                731304103    71354361320
!  19         19                  064022144   525163451                412120105    23267465420
!
!  * Short cycled period 10230
! ** Short cycled period 767250
!
!  NOTE: There are many other available initial register states which can be used for other signal transmitters including any additional SVs in future
!
!  IS-GPS-200H (24 Sep 2013), page 9
!
!  Table 3-IIa. Code Phase Assignments (IIR-M, IIF, and subsequent blocks only) (sheet 2 of 2)
!
!  SV ID No.  GPS PRN Signal No.  Initial Shift Register State (Octal) End Shift Register State (Octal)
!  L2 CM      L2 CL               L2 CM*                               L2 CL**
!  --------------------------------------------------------------------------------------------
!  20         20                  120161274    266527765               365636111    64173315520
!  21         21                  044023533    006760703               143324657    73012534520
!  22         22                  724744327    501474556               110766462    00031607420
!  23         23                  045743577    743747443               602405203    17131361420
!  24         24                  741201660    615534726               177735650    00152366220
!  25         25                  700274134    763621420               630177560    02345725020
!  26         26                  010247261    720727474               653467107    33073325420
!  27         27                  713433445    700521043               406576630    62505572620
!  28         28                  737324162    222567263               221777100    47652406120
!  29         29                  311627434    132765304               773266673    60206603120
!  30         30                  710452007    746332245               100010710    01241252620
!  31         31                  722462133    102300466               431037132    70514450120
!  32         32                  050172213    255231716               624127475    61537317120
!  65         33                  500653703    437661701               154624012    04163766420
!  66         34                  755077436    717047302               275636742    10010726420
!  67         35                  136717361    222614207               644341556    63425172320
!  68         36                  756675453    561123307               514260662    25701203220
!  69         37                  435506112    240713073               133501670    70370242320
!
!  * Short cycled period 10230
! ** Short cycled period 767250
!
!  NOTE: There are many other available initial register states which can be used for other signal transmitters including any additional SVs in future.
!
!
!  IS-GPS-200H (24 Sep 2013), page 10
!
!  Table 3-IIb. Expanded Code Phase Assignments (III and subsequent blocks only)
!
!  SV ID No.  GPS PRN Signal No.  Initial Shift Register State (Octal) End Shift Register State (Octal)
!  L2 CM        L2 CL                   L2 CM*       L2 CL**
!  --------------------------------------------------------------------------------------------
!  70         38                  771353753    101232630               453413162    46362474120
!  71         39                  226107701    132525726               637760505    67342136720
!  72         40                  022025110    315216367               612775765    70300607520
!  73         41                  402466344    377046065               136315217    74656650720
!  74         42                  752566114    655351360               264252240    44402271420
!  75         43                  702011164    435776513               113027466    13664557020
!  76         44                  041216771    744242321               774524245    64575230020
!  77         45                  047457275    024346717               161633757    65611334120
!  78         46                  266333164    562646415               603442167    01570510620
!  79         47                  713167356    731455342               213146546    00275746620
!  80         48                  060546335    723352536               721323277    10027337020
!  81         49                  355173035    000013134               207073253    30446361520
!  82         50                  617201036    011566642               130632332    05434165720
!  83         51                  157465571    475432222               606370621    33327670420
!  84         52                  767360553    463506741               330610170    75023141620
!  85         53                  023127030    617127534               744312067    54144532620
!  86         54                  431343777    026050332               154235152    31621657320
!  87         55                  747317317    733774235               525024652    00736040620
!  88         56                  045706125    751477772               535207413    11211477420
!  89         57                  002744276    417631550               655375733    04230331620
!  90         58                  060036467    052247456               316666241    35315052120
!  91         59                  217744147    560404163               525453337    04451115420
!  92         60                  603340174    417751005               114323414    24441014420
!  93         61                  326616775    004302173               755234667    56232465720
!  94         62                  063240065    715005045               526032633    02750153420
!  95         63                  111460621    001154457               602375063    52124037320
!
!  * Short cycled period 10230
! ** Short cycled period 767250.
!
!  NOTE #1: There are many other available initial register states which can be used for other signal transmitters including any additional SVs in future. 
!  NOTE #2: PRNs 38-63 are required per this Table if a manufacturer chooses to include these PRNs in their receiver design.
!
!  IS-GPS-200H (24 Sep 2013), page 10
!
!  Table 6-II. Additional L2 CM-/L2 CL-Code Phase Assignments (sheet 1 of 2
!
!  PRN Signal No.  Initial Shift Register State (Octal) End Shift Register tate (Octal)
!                  L2 CM        L2 CL                   L2 CM*        L2 CL**
!  ------------------------------------------------------------------------------
!  159             604055104    605253024               425373114    04454754420
!  160             157065232    063314262               427153064    70711611520
!  161             013305707    066073422               310366577    41226403720
!  162             603552017    737276117               623710414    22375503220
!  163             230461355    737243704               252761705    40311417420
!  164             603653437    067557532               050174703    67150557520
!  165             652346475    227354537               050301454    60626101520
!  166             743107103    704765502               416652040    22302312020
!  167             401521277    044746712               050301251    37003554720
!  168             167335110    720535263               744136527    51610130420
!  169             014013575    733541364               633772375    04411576620
!  170             362051132    270060042               007131446    70412551720
!  171             617753265    737176640               142007172    40633233020
!  172             216363634    133776704               655543571    50644663120
!  173             755561123    005645427               031272346    74370251120
!  174             365304033    704321074               203260313    02262327620
!  175             625025543    137740372               226613112    70422104520
!  176             054420334    056375464               736560607    37257772120
!  177             415473671    704374004               011741374    10517523020
!  178             662364360    216320123               765056120    76070131120
!  179             373446602    011322115               262725266    73714100120
!  180             417564100    761050112               013051476    22762761620
!  181             000526452    725304036               144541215    24515413420
!  182             226631300    721320336               534125243    04001576020
!  183             113752074    443462103               250001521    00215447220
!  184             706134401    510466244               276000566    30176776620
!  185             041352546    745522652               447447071    22647524620
!  186             664630154    373417061               000202044    73367301520
!  187             276524255    225526762               751430577    60250766720
!  188             714720530    047614504               136741270    75336255120
!  189             714051771    034730440               257252440    74626560120
!  190             044526647    453073141               757666513    03625320620
!
!  * Short cycled period 10230
! ** Short cycled period =3D 767250
!
!  IS-GPS-200H (24 Sep 2013), page 62-63
!  Table 6-II. Additional L2 CM-/L2 CL-Code Phase Assignments (sheet 2 of 2
!
!  PRN Signal No.  Initial Shift Register State (Octal) End Shift Register tate (Octal)
!                  L2 CM        L2 CL                   L2 CM*        L2 CL**
!  ------------------------------------------------------------------------------
!  191             207164322    533654510               606512137    20251277220
!  192             262120161    377016461               734247645    70123402320
!  193             204244652    235525312               415505547    72204337720
!  194             202133131    507056307               705146647    24075105220
!  195             714351204    221720061               006215430    37567404320
!  196             657127260    520470122               371216176    16667705620
!  197             130567507    603764120               645502771    12305536220
!  198             670517677    145604016               455175106    70701766520
!  199             607275514    051237167               127161032    43750324120
!  200             045413633    033326347               470332401    27560515520
!  201             212645405    534627074               252026355    37633326620
!  202             613700455    645230164               113771472    46752355620
!  203             706202440    000171400               754447142    14413253720
!  204             705056276    022715417               627405712    45102420520
!  205             020373522    135471311               325721745    72244642720
!  206             746013617    137422057               056714616    41237626120
!  207             132720621    714426456               706035241    44157017220
!  208             434015513    640724672               173076740    06321771020
!  209             566721727    501254540               145721746    11032065620
!  210             140633660    513322453               465052527    11376550620
!
!  * Short cycled period 10230
! ** Short cycled period 767250

    use iso_c_binding
    implicit none
    public  :: lfsr, lfsr_init, & 
               code_table, codebook, &
               N_CODES
    private :: poly
    
    integer :: poly
    integer(c_int), parameter :: N_CODES       = 219
    integer(c_int), parameter :: N_FIELDS      = 5
    integer(c_int), parameter :: CODE_LENGTH_1 = 10230
    integer(c_int), parameter :: CODE_LENGTH_2 = 767250

    integer(c_int), allocatable, dimension(:,:), save :: codebook
    
    integer(c_int), dimension(N_CODES, N_FIELDS) :: code_table
    data code_table /                                                                           &
       1,             o'742417664',  o'624145772',               o'552566002',   o'267724236',  &
       2,             o'756014035',  o'506610362',               o'034445034',   o'167516066',  &
       3,             o'002747144',  o'220360016',               o'723443711',   o'771756405',  &
       4,             o'066265724',  o'710406104',               o'511222013',   o'047202624',  &
       5,             o'601403471',  o'001143345',               o'463055213',   o'052770433',  &
       6,             o'703232733',  o'053023326',               o'667044524',   o'761743665',  &
       7,             o'124510070',  o'652521276',               o'652322653',   o'133015726',  &
       8,             o'617316361',  o'206124777',               o'505703344',   o'610611511',  &
       9,             o'047541621',  o'015563374',               o'520302775',   o'352150323',  &
      10,             o'733031046',  o'561522076',               o'244205506',   o'051266046',  &
      11,             o'713512145',  o'023163525',               o'236174002',   o'305611373',  &
      12,             o'024437606',  o'117776450',               o'654305531',   o'504676773',  &
      13,             o'021264003',  o'606516355',               o'435070571',   o'272572634',  &
      14,             o'230655351',  o'003037343',               o'630431251',   o'731320771',  &
      15,             o'001314400',  o'046515565',               o'234043417',   o'631326563',  &
      16,             o'222021506',  o'671511621',               o'535540745',   o'231516360',  &
      17,             o'540264026',  o'605402220',               o'043056734',   o'030367366',  &
      18,             o'205521705',  o'002576207',               o'731304103',   o'713543613',  &
      19,             o'064022144',  o'525163451',               o'412120105',   o'232674654',  &
      20,             o'120161274',  o'266527765',               o'365636111',   o'641733155',  &
      21,             o'044023533',  o'006760703',               o'143324657',   o'730125345',  &
      22,             o'724744327',  o'501474556',               o'110766462',   o'000316074',  &
      23,             o'045743577',  o'743747443',               o'602405203',   o'171313614',  &
      24,             o'741201660',  o'615534726',               o'177735650',   o'001523662',  &
      25,             o'700274134',  o'763621420',               o'630177560',   o'023457250',  &
      26,             o'010247261',  o'720727474',               o'653467107',   o'330733254',  &
      27,             o'713433445',  o'700521043',               o'406576630',   o'625055726',  &
      28,             o'737324162',  o'222567263',               o'221777100',   o'476524061',  &
      29,             o'311627434',  o'132765304',               o'773266673',   o'602066031',  &
      30,             o'710452007',  o'746332245',               o'100010710',   o'012412526',  &
      31,             o'722462133',  o'102300466',               o'431037132',   o'705144501',  &
      32,             o'050172213',  o'255231716',               o'624127475',   o'615373171',  &
      33,             o'500653703',  o'437661701',               o'154624012',   o'041637664',  &
      34,             o'755077436',  o'717047302',               o'275636742',   o'100107264',  &
      35,             o'136717361',  o'222614207',               o'644341556',   o'634251723',  &
      36,             o'756675453',  o'561123307',               o'514260662',   o'257012032',  &
      37,             o'435506112',  o'240713073',               o'133501670',   o'703702423',  &
      38,             o'771353753',  o'101232630',               o'453413162',   o'463624741',  &
      39,             o'226107701',  o'132525726',               o'637760505',   o'673421367',  &
      40,             o'022025110',  o'315216367',               o'612775765',   o'703006075',  &
      41,             o'402466344',  o'377046065',               o'136315217',   o'746566507',  &
      42,             o'752566114',  o'655351360',               o'264252240',   o'444022714',  &
      43,             o'702011164',  o'435776513',               o'113027466',   o'136645570',  &
      44,             o'041216771',  o'744242321',               o'774524245',   o'645752300',  &
      45,             o'047457275',  o'024346717',               o'161633757',   o'656113341',  &
      46,             o'266333164',  o'562646415',               o'603442167',   o'015705106',  &
      47,             o'713167356',  o'731455342',               o'213146546',   o'002757466',  &
      48,             o'060546335',  o'723352536',               o'721323277',   o'100273370',  &
      49,             o'355173035',  o'000013134',               o'207073253',   o'304463615',  &
      50,             o'617201036',  o'011566642',               o'130632332',   o'054341657',  &
      51,             o'157465571',  o'475432222',               o'606370621',   o'333276704',  &
      52,             o'767360553',  o'463506741',               o'330610170',   o'750231416',  &
      53,             o'023127030',  o'617127534',               o'744312067',   o'541445326',  &
      54,             o'431343777',  o'026050332',               o'154235152',   o'316216573',  &
      55,             o'747317317',  o'733774235',               o'525024652',   o'007360406',  &
      56,             o'045706125',  o'751477772',               o'535207413',   o'112114774',  &
      57,             o'002744276',  o'417631550',               o'655375733',   o'042303316',  &
      58,             o'060036467',  o'052247456',               o'316666241',   o'353150521',  &
      59,             o'217744147',  o'560404163',               o'525453337',   o'044511154',  &
      60,             o'603340174',  o'417751005',               o'114323414',   o'244410144',  &
      61,             o'326616775',  o'004302173',               o'755234667',   o'562324657',  &
      62,             o'063240065',  o'715005045',               o'526032633',   o'027501534',  &
      63,             o'111460621',  o'001154457',               o'602375063',   o'521240373',  &
      64,             o'0',          o'0',                       o'0',           o'0',          &
      65,             o'0',          o'0',                       o'0',           o'0',          &
      66,             o'0',          o'0',                       o'0',           o'0',          &
      67,             o'0',          o'0',                       o'0',           o'0',          &
      68,             o'0',          o'0',                       o'0',           o'0',          &
      69,             o'0',          o'0',                       o'0',           o'0',          &
      70,             o'0',          o'0',                       o'0',           o'0',          &
      71,             o'0',          o'0',                       o'0',           o'0',          &
      72,             o'0',          o'0',                       o'0',           o'0',          &
      73,             o'0',          o'0',                       o'0',           o'0',          &
      74,             o'0',          o'0',                       o'0',           o'0',          &
      75,             o'0',          o'0',                       o'0',           o'0',          &
      76,             o'0',          o'0',                       o'0',           o'0',          &
      77,             o'0',          o'0',                       o'0',           o'0',          &
      78,             o'0',          o'0',                       o'0',           o'0',          &
      79,             o'0',          o'0',                       o'0',           o'0',          &
      80,             o'0',          o'0',                       o'0',           o'0',          &
      81,             o'0',          o'0',                       o'0',           o'0',          &
      82,             o'0',          o'0',                       o'0',           o'0',          &
      83,             o'0',          o'0',                       o'0',           o'0',          &
      84,             o'0',          o'0',                       o'0',           o'0',          &
      85,             o'0',          o'0',                       o'0',           o'0',          &
      86,             o'0',          o'0',                       o'0',           o'0',          &
      87,             o'0',          o'0',                       o'0',           o'0',          &
      88,             o'0',          o'0',                       o'0',           o'0',          &
      89,             o'0',          o'0',                       o'0',           o'0',          &
      90,             o'0',          o'0',                       o'0',           o'0',          &
      91,             o'0',          o'0',                       o'0',           o'0',          &
      92,             o'0',          o'0',                       o'0',           o'0',          &
      93,             o'0',          o'0',                       o'0',           o'0',          &
      94,             o'0',          o'0',                       o'0',           o'0',          &
      95,             o'0',          o'0',                       o'0',           o'0',          &
      96,             o'0',          o'0',                       o'0',           o'0',          &
      97,             o'0',          o'0',                       o'0',           o'0',          &
      98,             o'0',          o'0',                       o'0',           o'0',          &
      99,             o'0',          o'0',                       o'0',           o'0',          &
     101,             o'0',          o'0',                       o'0',           o'0',          &
     102,             o'0',          o'0',                       o'0',           o'0',          &
     103,             o'0',          o'0',                       o'0',           o'0',          &
     104,             o'0',          o'0',                       o'0',           o'0',          &
     105,             o'0',          o'0',                       o'0',           o'0',          &
     106,             o'0',          o'0',                       o'0',           o'0',          &
     107,             o'0',          o'0',                       o'0',           o'0',          &
     108,             o'0',          o'0',                       o'0',           o'0',          &
     109,             o'0',          o'0',                       o'0',           o'0',          &
     110,             o'0',          o'0',                       o'0',           o'0',          &
     111,             o'0',          o'0',                       o'0',           o'0',          &
     112,             o'0',          o'0',                       o'0',           o'0',          &
     113,             o'0',          o'0',                       o'0',           o'0',          &
     114,             o'0',          o'0',                       o'0',           o'0',          &
     115,             o'0',          o'0',                       o'0',           o'0',          &
     116,             o'0',          o'0',                       o'0',           o'0',          &
     117,             o'0',          o'0',                       o'0',           o'0',          &
     118,             o'0',          o'0',                       o'0',           o'0',          &
     119,             o'0',          o'0',                       o'0',           o'0',          &
     120,             o'0',          o'0',                       o'0',           o'0',          &
     121,             o'0',          o'0',                       o'0',           o'0',          &
     122,             o'0',          o'0',                       o'0',           o'0',          &
     123,             o'0',          o'0',                       o'0',           o'0',          &
     124,             o'0',          o'0',                       o'0',           o'0',          &
     125,             o'0',          o'0',                       o'0',           o'0',          &
     126,             o'0',          o'0',                       o'0',           o'0',          &
     127,             o'0',          o'0',                       o'0',           o'0',          &
     128,             o'0',          o'0',                       o'0',           o'0',          &
     129,             o'0',          o'0',                       o'0',           o'0',          &
     120,             o'0',          o'0',                       o'0',           o'0',          &
     121,             o'0',          o'0',                       o'0',           o'0',          &
     122,             o'0',          o'0',                       o'0',           o'0',          &
     123,             o'0',          o'0',                       o'0',           o'0',          &
     124,             o'0',          o'0',                       o'0',           o'0',          &
     125,             o'0',          o'0',                       o'0',           o'0',          &
     126,             o'0',          o'0',                       o'0',           o'0',          &
     127,             o'0',          o'0',                       o'0',           o'0',          &
     128,             o'0',          o'0',                       o'0',           o'0',          &
     129,             o'0',          o'0',                       o'0',           o'0',          &
     130,             o'0',          o'0',                       o'0',           o'0',          &
     131,             o'0',          o'0',                       o'0',           o'0',          &
     132,             o'0',          o'0',                       o'0',           o'0',          &
     133,             o'0',          o'0',                       o'0',           o'0',          &
     134,             o'0',          o'0',                       o'0',           o'0',          &
     135,             o'0',          o'0',                       o'0',           o'0',          &
     136,             o'0',          o'0',                       o'0',           o'0',          &
     137,             o'0',          o'0',                       o'0',           o'0',          &
     138,             o'0',          o'0',                       o'0',           o'0',          &
     139,             o'0',          o'0',                       o'0',           o'0',          &
     140,             o'0',          o'0',                       o'0',           o'0',          &
     141,             o'0',          o'0',                       o'0',           o'0',          &
     142,             o'0',          o'0',                       o'0',           o'0',          &
     143,             o'0',          o'0',                       o'0',           o'0',          &
     144,             o'0',          o'0',                       o'0',           o'0',          &
     145,             o'0',          o'0',                       o'0',           o'0',          &
     146,             o'0',          o'0',                       o'0',           o'0',          &
     147,             o'0',          o'0',                       o'0',           o'0',          &
     148,             o'0',          o'0',                       o'0',           o'0',          &
     149,             o'0',          o'0',                       o'0',           o'0',          &
     150,             o'0',          o'0',                       o'0',           o'0',          &
     151,             o'0',          o'0',                       o'0',           o'0',          &
     152,             o'0',          o'0',                       o'0',           o'0',          &
     153,             o'0',          o'0',                       o'0',           o'0',          &
     154,             o'0',          o'0',                       o'0',           o'0',          &
     155,             o'0',          o'0',                       o'0',           o'0',          &
     156,             o'0',          o'0',                       o'0',           o'0',          &
     157,             o'0',          o'0',                       o'0',           o'0',          &
     158,             o'0',          o'0',                       o'0',           o'0',          &
     159,             o'604055104',  o'605253024',               o'425373114',   o'044547544',  &
     160,             o'157065232',  o'063314262',               o'427153064',   o'707116115',  &
     161,             o'013305707',  o'066073422',               o'310366577',   o'412264037',  &
     162,             o'603552017',  o'737276117',               o'623710414',   o'223755032',  &
     163,             o'230461355',  o'737243704',               o'252761705',   o'403114174',  &
     164,             o'603653437',  o'067557532',               o'050174703',   o'671505575',  &
     165,             o'652346475',  o'227354537',               o'050301454',   o'606261015',  &
     166,             o'743107103',  o'704765502',               o'416652040',   o'223023120',  &
     167,             o'401521277',  o'044746712',               o'050301251',   o'370035547',  &
     168,             o'167335110',  o'720535263',               o'744136527',   o'516101304',  &
     169,             o'014013575',  o'733541364',               o'633772375',   o'044115766',  &
     170,             o'362051132',  o'270060042',               o'007131446',   o'704125517',  &
     171,             o'617753265',  o'737176640',               o'142007172',   o'406332330',  &
     172,             o'216363634',  o'133776704',               o'655543571',   o'506446631',  &
     173,             o'755561123',  o'005645427',               o'031272346',   o'743702511',  &
     174,             o'365304033',  o'704321074',               o'203260313',   o'022623276',  &
     175,             o'625025543',  o'137740372',               o'226613112',   o'704221045',  &
     176,             o'054420334',  o'056375464',               o'736560607',   o'372577721',  &
     177,             o'415473671',  o'704374004',               o'011741374',   o'105175230',  &
     178,             o'662364360',  o'216320123',               o'765056120',   o'760701311',  &
     179,             o'373446602',  o'011322115',               o'262725266',   o'737141001',  &
     180,             o'417564100',  o'761050112',               o'013051476',   o'227627616',  &
     181,             o'000526452',  o'725304036',               o'144541215',   o'245154134',  &
     182,             o'226631300',  o'721320336',               o'534125243',   o'040015760',  &
     183,             o'113752074',  o'443462103',               o'250001521',   o'002154472',  &
     184,             o'706134401',  o'510466244',               o'276000566',   o'301767766',  &
     185,             o'041352546',  o'745522652',               o'447447071',   o'226475246',  &
     186,             o'664630154',  o'373417061',               o'000202044',   o'733673015',  &
     187,             o'276524255',  o'225526762',               o'751430577',   o'602507667',  &
     188,             o'714720530',  o'047614504',               o'136741270',   o'753362551',  &
     189,             o'714051771',  o'034730440',               o'257252440',   o'746265601',  &
     190,             o'044526647',  o'453073141',               o'757666513',   o'036253206',  &
     191,             o'207164322',  o'533654510',               o'606512137',   o'202512772',  &
     192,             o'262120161',  o'377016461',               o'734247645',   o'701234023',  &
     193,             o'204244652',  o'235525312',               o'415505547',   o'722043377',  &
     194,             o'202133131',  o'507056307',               o'705146647',   o'240751052',  &
     195,             o'714351204',  o'221720061',               o'006215430',   o'375674043',  &
     196,             o'657127260',  o'520470122',               o'371216176',   o'166677056',  &
     197,             o'130567507',  o'603764120',               o'645502771',   o'123055362',  &
     198,             o'670517677',  o'145604016',               o'455175106',   o'707017665',  &
     199,             o'607275514',  o'051237167',               o'127161032',   o'437503241',  &
     200,             o'045413633',  o'033326347',               o'470332401',   o'275605155',  &
     201,             o'212645405',  o'534627074',               o'252026355',   o'376333266',  &
     202,             o'613700455',  o'645230164',               o'113771472',   o'467523556',  &
     203,             o'706202440',  o'000171400',               o'754447142',   o'144132537',  &
     204,             o'705056276',  o'022715417',               o'627405712',   o'451024205',  &
     205,             o'020373522',  o'135471311',               o'325721745',   o'722446427',  &
     206,             o'746013617',  o'137422057',               o'056714616',   o'412376261',  &
     207,             o'132720621',  o'714426456',               o'706035241',   o'441570172',  &
     208,             o'434015513',  o'640724672',               o'173076740',   o'063217710',  &
     209,             o'566721727',  o'501254540',               o'145721746',   o'110320656',  &
     210,             o'140633660',  o'513322453',               o'465052527',   o'113765506'   &
  /

  contains

    recursive function lfsr(reg, k) result(new_reg) bind(c, name="l2c_lfsr") 
      
      integer(c_int), intent(in) :: reg
      integer(c_int), intent(in) :: k
      integer(c_int)             :: new_reg ! result
      integer                    :: it
      new_reg = reg
      do it = 1, k, 1
        new_reg = ieor(new_reg, poly)
        new_reg = ishft(new_reg, 1)
      end do
      
    end function lfsr

    subroutine lfsr_init() bind(c, name="l2c_init")
      allocate(codebook(N_CODES,CODE_LENGTH_1))
      return
    end subroutine lfsr_init

  end module l2c

! *EOF*
